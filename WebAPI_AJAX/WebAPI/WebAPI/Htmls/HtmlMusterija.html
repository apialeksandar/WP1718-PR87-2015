<!DOCTYPE html>
<html>
<head>
	<title>Taksi sluzba</title>
	<meta charset="utf-8" />
	<style>
		/* Set height of body and the document to 100% to enable "full page tabs" */
		body, html {
			height: 100%;
			margin: 0;
			font-family: Arial;
		}

		/* Style tab links */
		.tablink {
			background-color: #555;
			color: white;
			float: left;
			border: none;
			outline: none;
			cursor: pointer;
			padding: 14px 16px;
			font-size: 17px;
			width: 25%;
		}

			.tablink:hover {
				background-color: #777;
			}

		/* Style the tab content (and add height:100% for full page content) */
		.tabcontent {
			color: black;
			display: none;
			padding: 100px 20px;
			height: 100%;
		}
	</style>

	<script src="Scripts/jquery-1.10.2.js"></script>
	<script src="Scripts/jquery.validate.js"></script>
	<script src="Scripts/globalVar.js"></script>

	<script type="text/javascript">

		function openPage(pageName, elmnt, color) {
		// Hide all elements with class="tabcontent" by default */
		var i, tabcontent, tablinks;
		tabcontent = document.getElementsByClassName("tabcontent");
		for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		}

		// Remove the background color of all tablinks/buttons
		tablinks = document.getElementsByClassName("tablink");
		for (i = 0; i < tablinks.length; i++) {
			tablinks[i].style.backgroundColor = "";
		}

		// Show the specific tab content
		document.getElementById(pageName).style.display = "block";

		// Add the specific color to the button used to open the tab content
		elmnt.style.backgroundColor = color;
		}

		function obrisi(i)
		{
			var pom = i;
			globalSet(pom);

			loadKomentar();
		}

		function izmeni(i)
		{
			var pom = i;

				$.ajax({
					url: 'api/izmeniVoznju/post',
					method: 'POST',
					data: {
						Ime: pom,
					},
					success: function (data)
					{
						$("#ulica").val(data.LokacijaNaKojuTaksiDolazi.Adresa.Ulica);
						$("#broj").val(data.LokacijaNaKojuTaksiDolazi.Adresa.Broj);
						$("#naseljenoMesto").val(data.LokacijaNaKojuTaksiDolazi.Adresa.NaseljenoMesto);
						$("#pozivniBroj").val(data.LokacijaNaKojuTaksiDolazi.Adresa.PozivniBrojMesta)
						if (data.ZeljeniTipAutomobila == 0) {
							$("#putnickiAutomobil").attr("selected", "true");
						}
						else {
							$("#kombiVozilo").attr("selected", "true");
						}
					},
				});

		}

		function filtriraj() {
			$.ajax({
				url: 'api/filtrirajMusterija/post',
				method: 'POST',
				data: {
					StatusVoznje: document.getElementById("sortStatusVoznja").value,
				},
				success: function (data) {
					$("#sveVoznjeMusterijaTabela").empty();
					var s1 = $("<th></th>").text("Ulica(pocetak)");
					var s2 = $("<th></th>").text("Broj(pocetak)");
					var s3 = $("<th></th>").text("Grad(pocetak)");
					var s4 = $("<th></th>").text("Dispecer");
					var s5 = $("<th></th>").text("Iznos");
					var s6 = $("<th></th>").text("Status voznje");
					var s7 = $("<th></th>").text("Vozac");
					/*var s8 = $("<th></th>").text("Ulica(odrediste)");
					var s9 = $("<th></th>").text("Broj(odrediste)");
					var s10 = $("<th></th>").text("Grad(odrediste)");*/
					$("#sveVoznjeMusterijaTabela").append("<tr>", s1, s2, s3, s4, s5, s6, s7, "</tr>");

					var i;

					for (i = 0; i < data.length; i++) {
						var txt1 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Ulica);
						var txt2 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Broj);
						var txt3 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.NaseljenoMesto);
						var txt4 = $("<td></td>").text(data[i].Dispecer);
						var txt5 = $("<td></td>").text(data[i].Iznos);
						var txt6 = $("<td></td>").text(data[i].StatusVoznje);
						var txt7 = $("<td></td>").text(data[i].Vozac)
						/*var txt8 = $("<td></td>").text(data[i].Odrediste.Adresa.Ulica);
						var txt9 = $("<td></td>").text(data[i].Odrediste.Adresa.Broj);
						var txt10 = $("<td></td>").text(data[i].Odrediste.Adresa.NaseljenoMesto);*/
						$("#sveVoznjeMusterijaTabela").append("<tr>", txt1, txt2, txt3, txt4, txt5, txt6, txt7, "</tr>");
					}
				}
			});
		}

		function sortirajDatum()
		{
			$.ajax({
				url: 'api/sortirajDatumMusterija/post',
				method: 'POST',
				success: function (data) {
					$("#sveVoznjeMusterijaTabela").empty();
					var s1 = $("<th></th>").text("Ulica(pocetak)");
					var s2 = $("<th></th>").text("Broj(pocetak)");
					var s3 = $("<th></th>").text("Grad(pocetak)");
					var s4 = $("<th></th>").text("Dispecer");
					var s5 = $("<th></th>").text("Iznos");
					var s6 = $("<th></th>").text("Status voznje");
					var s7 = $("<th></th>").text("Vozac");
					/*var s8 = $("<th></th>").text("Ulica(odrediste)");
					var s9 = $("<th></th>").text("Broj(odrediste)");
					var s10 = $("<th></th>").text("Grad(odrediste)");*/
					$("#sveVoznjeMusterijaTabela").append("<tr>", s1, s2, s3, s4, s5, s6, s7, "</tr>");

					var i;

					for (i = 0; i < data.length; i++) {
						var txt1 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Ulica);
						var txt2 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Broj);
						var txt3 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.NaseljenoMesto);
						var txt4 = $("<td></td>").text(data[i].Dispecer);
						var txt5 = $("<td></td>").text(data[i].Iznos);
						var txt6 = $("<td></td>").text(data[i].StatusVoznje);
						var txt7 = $("<td></td>").text(data[i].Vozac)
						/*var txt8 = $("<td></td>").text(data[i].Odrediste.Adresa.Ulica);
						var txt9 = $("<td></td>").text(data[i].Odrediste.Adresa.Broj);
						var txt10 = $("<td></td>").text(data[i].Odrediste.Adresa.NaseljenoMesto);*/
						$("#sveVoznjeMusterijaTabela").append("<tr>", txt1, txt2, txt3, txt4, txt5, txt6, txt7, "</tr>");
					}
				}
			});
		}

	</script>
	<script type="text/javascript">
		$(document).ready(function () {
			jQuery('#Myprofile').click();			// HOME PAGE!!!!!!!!!!

			 $("#Myprofile").click(function () {
				$.get("/api/musterija", function (data, status) {
					$("#korisnickoIme").val(data.KorisnickoIme);
					$("#ime").val(data.Ime);
					$("#prezime").val(data.Prezime);
					$("#kontaktTelefon").val(data.KontaktTelefon);
					$("#lozinka").val(data.Lozinka);
					$("#jmbg").val(data.Jmbg);
					$("#email").val(data.Email);
					$("#uloga").val(data.Uloga);
					$("#voznje").val(data.VoznjeKorisnika);

					if (data.Pol == 0) {
						$("#Muski").attr("selected", "true");
					}
					else {
						$("#Zenski").attr("selected", "true");
					}
				});
			 });

			 $("#PocetnA").click(function () {
			 	$("#tabela").empty();
			 	var s1 = $("<th></th>").text("Datum i vreme narudzbe");
			 	var s2 = $("<th></th>").text("Ulica");
			 	var s3 = $("<th></th>").text("Broj");
			 	var s4 = $("<th></th>").text("Grad");
			 	var s5 = $("<th></th>").text("Pozivni broj mesta");
			 	var s6 = $("<th></th>").text("Dispecer");
			 	var s7 = $("<th></th>").text("Iznos");
			 	var s8 = $("<th></th>").text("Status voznje");
			 	var s9 = $("<th colspan=\"2\"></th>").text("Opcije");
			 	$("#tabela").append("<tr>", s1, s2, s3, s4, s5, s6, s7, s8, s9, "</tr>");

			 	$.get("/api/voznje", function (data, status) 
			 	{
			 		var i;

			 		for (i = 0; i < data.length; i++)
			 		{
			 			var txt1 = $("<td></td>").text(data[i].DatumIVremePorudzbine);
			 			var txt2 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Ulica);
			 			var txt3 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Broj);
			 			var txt4 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.NaseljenoMesto);
			 			var txt5 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.PozivniBrojMesta);
			 			var txt6 = $("<td></td>").text(data[i].Dispecer);
			 			var txt7 = $("<td></td>").text(data[i].Iznos);
			 			var txt8 = $("<td></td>").text(data[i].StatusVoznje);
			 			var txt9 = $("<input type=\"submit\" value=\"izmeni\" onclick=\"izmeni(" + i + ")\">").attr("id", "izmeni_" + i);
			 			var txt10 = $("<input type=\"submit\" value=\"obrisi\" onclick=\"obrisi(" + i + ")\">").attr("id", "obrisi_" + i);
			 			$("#tabela").append("<tr>", txt1, txt2, txt3, txt4, txt5, txt6, txt7, txt8, txt9, txt10, "</tr>");
			 		}
			 		
			 	});
			 });

			 $("#sveVoznje").click(function ()
			 {
			 	$("#sveVoznjeMusterijaTabela").empty();
			 	var s1 = $("<th></th>").text("Ulica(pocetak)");
			 	var s2 = $("<th></th>").text("Broj(pocetak)");
			 	var s3 = $("<th></th>").text("Grad(pocetak)");
			 	var s4 = $("<th></th>").text("Dispecer");
			 	var s5 = $("<th></th>").text("Iznos");
			 	var s6 = $("<th></th>").text("Status voznje");
			 	var s7 = $("<th></th>").text("Vozac");
			 	/*var s8 = $("<th></th>").text("Ulica(odrediste)");
			 	var s9 = $("<th></th>").text("Broj(odrediste)");
			 	var s10 = $("<th></th>").text("Grad(odrediste)");*/
			 	$("#sveVoznjeMusterijaTabela").append("<tr>", s1, s2, s3, s4, s5, s6, s7, "</tr>");

			 	$.get("/api/sveVoznjeMusterija", function (data, status)
			 	{
			 		var i;

			 		for (i = 0; i < data.length; i++) {
			 			var txt1 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Ulica);
			 			var txt2 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.Broj);
			 			var txt3 = $("<td></td>").text(data[i].LokacijaNaKojuTaksiDolazi.Adresa.NaseljenoMesto);
			 			var txt4 = $("<td></td>").text(data[i].Dispecer);
			 			var txt5 = $("<td></td>").text(data[i].Iznos);
			 			var txt6 = $("<td></td>").text(data[i].StatusVoznje);
			 			var txt7 = $("<td></td>").text(data[i].Vozac)
			 			/*var txt8 = $("<td></td>").text(data[i].Odrediste.Adresa.Ulica);
			 			var txt9 = $("<td></td>").text(data[i].Odrediste.Adresa.Broj);
			 			var txt10 = $("<td></td>").text(data[i].Odrediste.Adresa.NaseljenoMesto);*/
			 			$("#sveVoznjeMusterijaTabela").append("<tr>", txt1, txt2, txt3, txt4, txt5, txt6, txt7, "</tr>");
			 		}
			 	});
			});
		});

		
	</script>
</head>
<body>
	<h1>MUSTERIJA</h1>
	<!-- Tab links -->

	<button class="tablink" onclick="openPage('Sve voznje', this)" id="sveVoznje">Sve voznje</button>
	<button class="tablink" onclick="openPage('Pocetna', this)" id="PocetnA">Voznje na cekanju</button>
	<button class="tablink" onclick="openPage('My Profile', this)" id="Myprofile">My Profile</button>
	<button class="tablink" onclick="openPage('Zahtev za voznju', this)">Zahtev za voznju</button>

	<div id="Sve voznje" class="tabcontent">
		<table id="sveVoznjeMusterijaTabela" border="1">
		</table>
		<select id="sortStatusVoznja">
			<option value="Izaberi..." id="Izaberi...">Izaberi...</option>
			<option value="NaCekanju" id="NaCekanju">NaCekanju</option>
			<option value="Formirana" id="Formirana">Formirana</option>
			<option value="Obradjena" id="Obradjena">Obradjena</option>
			<option value="Prihvacena" id="Prihvacena">Prihvacena</option>
			<option value="Otkazana" id="Otkazana">Otkazana</option>
			<option value="Neuspesna" id="Neuspesna">Neuspesna</option>
			<option value="Uspesna" id="Uspesna">Uspesna</option>
		</select>
		<br/>
		<input type="submit" value="Filtriraj po statusu voznje" onclick="filtriraj()">
		<br />
		<input type="submit" value="Sortiraj po datumu" onclick="sortirajDatum()">
	</div>

	<div id="My Profile" class="tabcontent">
		<h3>My Profile</h3>
		<p>
			<form method="post" id="editMus">
				<table>
					<tr>
						<th colspan="2" align="center">Vaši podaci</th>
					</tr>
					<tr>
						<th>Korisnicko ime: </th>
						<td><input type="text" id="korisnickoIme" name="korisnickoIme" readonly></td>
					</tr>
					<tr>
						<th>Lozinka: </th>
						<td><input type="text" id="lozinka" name="lozinka"></td>
					</tr>
					<tr>
						<th>Ime: </th>
						<td><input type="text" id="ime" name="ime"></td>
					</tr>
					<tr>
						<th>Prezime: </th>
						<td><input type="text" id="prezime" name="prezime"></td>
					</tr>
					<tr>

						<th>Pol: </th>
						<td>
							<select id="pol" name="pol">
								<option value="Muski" id="Muski">Muski</option>
								<option value="Zenski" id="Zenski">Zenski</option>
							</select>
						</td>
					</tr>
					<tr>
						<th>JMBG: </th>
						<td><input type="text" id="jmbg" name="jmbg"></td>
					</tr>
					<tr>
						<th>Kontakt telefon: </th>
						<td><input type="text" id="kontaktTelefon" name="kontaktTelefon"></td>
					</tr>
					<tr>
						<th>E-mail: </th>
						<td><input type="text" id="email" name="email"></td>
					</tr>
					<tr>
						<td>
							<input type="hidden" id="uloga">
						</td>
					</tr>
					<tr>
						<td colspan="2" align="center"><input type="submit" value="Sačuvaj"></td>
					</tr>
				</table>
			</form>
			<script>
				validateMusterija();
			</script>
		</p>
	</div>

	<div id="Zahtev za voznju" class="tabcontent">
		<p>
			<form action="post" id="zahtevVoznje">
				<table>
					<tr>
						<th>Unesite ulicu: </th>
						<td><input type="text" id="ulica" name="Lokacija.Adresa.ulica"></td>
					</tr>
					<tr>
						<th>Unesite broj: </th>
						<td><input type="text" id="broj" name="Lokacija.Adresa.broj"></td>
					</tr>
					<tr>
						<th>Unesite mesto: </th>
						<td><input type="text" id="naseljenoMesto" name="Lokacija.Adresa.naseljenoMesto" value="Novi Sad" readonly></td>
					</tr>
					<tr>
						<th>Unesite pozivni broj mesta: </th>
						<td><input type="text" id="pozivniBroj" name="Lokacija.Adresa.pozivniBrojMesta" value="21000" readonly></td>
					</tr>
					<tr>
						<th>Izaberite tip vozila: </th>
						<td>
							<select id="tipAutomobila" name="Automobil.TipAutomobil">
								<option id="putnickiAutomobil" value="PutnickiAutomobil">Putnicki Automobil</option>
								<option id="kombiVozilo" value="KombiVozilo">Kombi Vozilo</option>
							</select>
						</td>
					</tr>
					<tr>
						<td><input type="submit" value="Posalji"></td>
					</tr>
				</table>
			</form>
			<script>validateZahtevVoznje();</script>
		</p>
	</div>

	<div id="Pocetna" class="tabcontent">
		<p>
			<table border="1" id="tabela">
				<tr>
					<th>Datum i vreme narudzbe</th>
					<th>Ulica</th>
					<th>Broj</th>
					<th>Grad</th>
					<th>Pozivni broj mesta</th>
					<th>Dispecer</th>
					<th>Iznos</th>
					<th>Status voznje</th>
				</tr>
			</table>
		</p>
	</div>

</body>
</html>

